{"ast":null,"code":"import _regeneratorRuntime from\"/Users/kamil.muzyka/Desktop/podcastify/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _objectSpread from\"/Users/kamil.muzyka/Desktop/podcastify/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _asyncToGenerator from\"/Users/kamil.muzyka/Desktop/podcastify/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/kamil.muzyka/Desktop/podcastify/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import{withRouter}from'react-router-dom';import{SEARCH_TYPES}from'../../../../constants';import Spotify from'../../../../models/Spotify';import extractId from'../../../../utils/extractId';import WorkspaceLoading from'../../WorkspaceLoading/WorkspaceLoading';import Details from'../../Details/Details';import EpisodesList from'../../Episodes/EpisodesList/EpisodesList';var Show=function Show(_ref){var location=_ref.location;var SHOW_ID=extractId(location.pathname);var _useState=useState({}),_useState2=_slicedToArray(_useState,2),details=_useState2[0],updateDetails=_useState2[1];var _useState3=useState({}),_useState4=_slicedToArray(_useState3,2),library=_useState4[0],updateLibrary=_useState4[1];var _useState5=useState(0),_useState6=_slicedToArray(_useState5,2),status=_useState6[0],updateStatus=_useState6[1];var _useState7=useState(true),_useState8=_slicedToArray(_useState7,2),isLoading=_useState8[0],updateIsLoading=_useState8[1];var handleShowFollow=function handleShowFollow(id){Spotify.saveUserShow(id);updateStatus(function(prev){return prev+1;});};var handleShowUnfollow=function handleShowUnfollow(id){Spotify.removeUserShow(id);updateStatus(function(prev){return prev+1;});};useEffect(function(){_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _yield$Promise$all,_yield$Promise$all2,show,inLibrary,_inLibrary;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;if(!(Object.keys(details).length===0)){_context.next=12;break;}_context.next=4;return Promise.all([Spotify.getShowDetails(SHOW_ID),Spotify.checkUserShow(SHOW_ID)]);case 4:_yield$Promise$all=_context.sent;_yield$Promise$all2=_slicedToArray(_yield$Promise$all,2);show=_yield$Promise$all2[0];inLibrary=_yield$Promise$all2[1];updateDetails({id:SHOW_ID,name:show.name,description:show.description,external:show.external_urls.spotify,type:SEARCH_TYPES.show,publisher:show.publisher,image:show.images[1].url,episodes:show.episodes.items});updateLibrary({inLibrary:inLibrary[0],addToLibraryText:'Follow',removeFromLibraryText:'Unfollow',addToLibrary:function addToLibrary(){return handleShowFollow(SHOW_ID);},removeFromLibrary:function removeFromLibrary(){return handleShowUnfollow(SHOW_ID);}});_context.next=16;break;case 12:_context.next=14;return Spotify.checkUserShow(SHOW_ID);case 14:_inLibrary=_context.sent;updateLibrary(function(prev){return _objectSpread(_objectSpread({},prev),{},{inLibrary:_inLibrary[0]});});case 16:updateIsLoading(false);_context.next=22;break;case 19:_context.prev=19;_context.t0=_context[\"catch\"](0);throw new Error(_context.t0);case 22:case\"end\":return _context.stop();}}},_callee,null,[[0,19]]);}))();},[SHOW_ID,status]);return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Details,{details:details,library:library}),/*#__PURE__*/React.createElement(EpisodesList,{details:details}),/*#__PURE__*/React.createElement(WorkspaceLoading,{loading:isLoading.toString()}));};export default withRouter(Show);","map":{"version":3,"sources":["/Users/kamil.muzyka/Desktop/podcastify/src/components/Workspace/Shows/Show/Show.js"],"names":["React","useState","useEffect","withRouter","SEARCH_TYPES","Spotify","extractId","WorkspaceLoading","Details","EpisodesList","Show","location","SHOW_ID","pathname","details","updateDetails","library","updateLibrary","status","updateStatus","isLoading","updateIsLoading","handleShowFollow","id","saveUserShow","prev","handleShowUnfollow","removeUserShow","Object","keys","length","Promise","all","getShowDetails","checkUserShow","show","inLibrary","name","description","external","external_urls","spotify","type","publisher","image","images","url","episodes","items","addToLibraryText","removeFromLibraryText","addToLibrary","removeFromLibrary","Error","toString"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { withRouter } from 'react-router-dom';\nimport { SEARCH_TYPES } from '../../../../constants';\nimport Spotify from '../../../../models/Spotify';\nimport extractId from '../../../../utils/extractId';\nimport WorkspaceLoading from '../../WorkspaceLoading/WorkspaceLoading';\nimport Details from '../../Details/Details';\nimport EpisodesList from '../../Episodes/EpisodesList/EpisodesList';\n\nconst Show = ({ location }) => {\n    const SHOW_ID = extractId(location.pathname);\n    const [details, updateDetails] = useState({});\n    const [library, updateLibrary] = useState({});\n    const [status, updateStatus] = useState(0);\n    const [isLoading, updateIsLoading] = useState(true);\n\n    const handleShowFollow = (id) => {\n        Spotify.saveUserShow(id);\n        updateStatus((prev) => prev + 1);\n    };\n\n    const handleShowUnfollow = (id) => {\n        Spotify.removeUserShow(id);\n        updateStatus((prev) => prev + 1);\n    };\n\n    useEffect(() => {\n        (async () => {\n            try {\n                if(Object.keys(details).length === 0) {\n                    const [show, inLibrary] = await Promise.all([\n                        Spotify.getShowDetails(SHOW_ID),\n                        Spotify.checkUserShow(SHOW_ID)\n                    ]);\n                    updateDetails({\n                        id: SHOW_ID,\n                        name: show.name,\n                        description: show.description,\n                        external: show.external_urls.spotify,\n                        type: SEARCH_TYPES.show,\n                        publisher: show.publisher,\n                        image: show.images[1].url,\n                        episodes: show.episodes.items\n                    });\n                    updateLibrary({\n                        inLibrary: inLibrary[0],\n                        addToLibraryText: 'Follow',\n                        removeFromLibraryText: 'Unfollow',\n                        addToLibrary: () => handleShowFollow(SHOW_ID),\n                        removeFromLibrary: () => handleShowUnfollow(SHOW_ID)\n                    });\n                } else {\n                    const inLibrary = await Spotify.checkUserShow(SHOW_ID);\n                    updateLibrary((prev) => {\n                        return {\n                            ...prev,\n                            inLibrary: inLibrary[0]\n                        }\n                    });\n                }\n                updateIsLoading(false);\n            } catch(err) {\n                throw new Error(err);\n            }\n        })();\n    }, [SHOW_ID, status]);\n\n    return (\n        <>\n            <Details details={details} library={library}/>\n            <EpisodesList details={details}/>\n            <WorkspaceLoading loading={isLoading.toString()}/>\n        </>\n    );\n}\n\nexport default withRouter(Show);"]},"metadata":{},"sourceType":"module"}